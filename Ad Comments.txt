https://www.interviewquery.com/questions/ad-comments

SQL :

with feed as
(
    select a.id , count(distinct b.comment_id) as feed_comm
    from  ads a join feed_comments b on a.id=b.ad_id
    group by 1
)
,moments as 
(
    select a.id , count(distinct b.comment_id) as moments_comm
    from ads a join moments_comments b on a.id=b.ad_id
    group by 1
)
select a.name,
       b.feed_comm*1.0/ (b.feed_comm+c.moments_comm) as percentage_feed,
       c.moments_comm*1.0/ (b.feed_comm+c.moments_comm) as percentage_moments
from ads a left join feed b on a.id=b.id
left join moments c on a.id=c.id